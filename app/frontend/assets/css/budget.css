/* ======= –ë–Æ–î–ñ–ï–¢ (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è) ======= */

*,
*::before,
*::after{ box-sizing: border-box; }

.budget-page{
  display:grid; gap:16px;
  font-variant-numeric: tabular-nums lining-nums;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}

:root{
  --safe-top: env(safe-area-inset-top);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
  --safe-right: env(safe-area-inset-right);
  --tg-top: 0px; /* –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –≤ Telegram –Ω–∞ iOS ‚Äî –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∏–∑ JS */
}

/* –±–∞–∑–æ–≤—ã–µ —Ñ–∏–∫—Å—ã */
html, body{ min-height:100%; }
body{
  min-height:100svh;
  padding-left: var(--safe-left);
  padding-right: var(--safe-right);
  margin: 0;
}

/* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–µ –ø–æ–ª—è –ø–æ –±–æ–∫–∞–º, —É—á—ë—Ç safe-area –∏ –ø–∞–Ω–µ–ª–∏ TG —Å–≤–µ—Ä—Ö—É */
.container{
  width: 100%;
  max-width: 1280px;
  margin-inline: auto;
  padding-inline: clamp(12px, 4vw, 24px);
  padding-top: calc(clamp(8px, var(--safe-top), 16px) + var(--tg-top));
  padding-bottom: clamp(8px, var(--safe-bottom), 16px);
}

/* —à–∞–ø–∫–∞ ‚Äî –æ–±—ã—á–Ω—ã–π –ø–æ—Ç–æ–∫ (–Ω–µ fixed/sticky), —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç */
.container > header,
.container > header.header--compact{
  position: static !important;
  top: auto !important; left: auto !important; right: auto !important;
  transform: none !important;
  margin-bottom: 12px;
  z-index: auto !important;
}

/* —Ç–∞–±-–±–∞—Ä –ø–æ–¥ —à–∞–ø–∫–æ–π –Ω–µ —Ç—è–Ω–µ—Ç —à–∏—Ä–∏–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
.tabs-row{
  display:flex; gap:10px; align-items:center;
  overflow-x:auto; -webkit-overflow-scrolling:touch;
  padding: 6px 2px 10px;
  max-width: 100%;
}
.tabs-row::-webkit-scrollbar{ display:none; }

/* –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –∫–ª–∏–∫–∏ –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ —Å–ª–æ—è–º–∏ */
.aurora, .blob{ pointer-events:none !important; }

/* –∫–∞—Ä—Ç–æ—á–∫–∏ */
.budget-page .card{
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border:1px solid var(--stroke); border-radius:16px; padding:16px;
  box-shadow:var(--shadow);
  max-width: 100%;             /* –≤–∞–∂–Ω–æ: –Ω–µ —à–∏—Ä–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
  overflow: hidden;             /* –≥–ª–æ—É/—Ç–µ–Ω–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞ */
}
.budget-page .card h2{ margin:0; font-size:18px }

/* –Ω–∞ —É–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö —É–∂–∏–º–∞–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–æ–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
@media (max-width: 420px){
  .budget-page .card{ padding:12px; }
}

/* –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ä—Ç–æ—á–∫–∏ */
.card-head{ display:flex; align-items:center; justify-content:space-between; gap:12px }
.head-between{ display:flex; justify-content:space-between; align-items:center; gap:12px }

/* –ø–∞–Ω–µ–ª—å –¥–µ–π—Å—Ç–≤–∏–π –≤–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ü–∏–∏ */
.section-toolbar{ display:flex; justify-content:flex-end; margin:4px 0 12px; gap:10px }

/* +–î–æ–±–∞–≤–∏—Ç—å */
.btn-add{
  display:inline-flex; align-items:center; gap:8px;
  padding:10px 14px; border-radius:14px; font-weight:800;
  background:linear-gradient(135deg, var(--brand), var(--brand2));
  color:#0c0f21; border:0; box-shadow:var(--shadow);
}
.btn-add .plus{ font-size:18px; line-height:1 }
.btn-sm{ padding:6px 10px; font-size:12px; border-radius:10px; }

/* collapsible */
.budget-page .collapsible>summary{
  list-style:none; cursor:pointer; display:flex; align-items:center;
  margin:-4px 0 10px;
}
.budget-page .collapsible>summary::-webkit-details-marker{ display:none }
.budget-page .chev{ display:inline-block; width:1em; height:1em; margin-right:8px; transform-origin:center; transition:transform .25s ease; font-weight:900; color:var(--muted) }
.budget-page .collapsible[open] .chev{ transform:rotate(90deg) }

/* KPI */
.budget-page .kpis{ display:grid; grid-template-columns:repeat(4,1fr); gap:12px; max-width:100%; }
.budget-page .kpi{ background:var(--input-bg); border:1px solid var(--stroke); border-radius:12px; padding:12px }
.budget-page .kpi__label{ font-size:12px; color:var(--muted) }
.budget-page .kpi__value{ font-size:22px; font-weight:800; margin-top:6px }

/* —Å–µ—Ç–∫–∏ */
.budget-page .grid{ display:grid; gap:16px; max-width:100%; }
.budget-page .grid--2{ grid-template-columns:1fr }
@media (min-width:960px){ .budget-page .grid--2{ grid-template-columns:1fr 1fr } }

/* —Ñ–æ—Ä–º—ã */
.budget-page .form{ display:grid; gap:12px; max-width:100%; }
.budget-page .form__row{ display:grid; gap:12px; margin-bottom:12px }
@media (min-width:860px){ .budget-page .form__row{ grid-template-columns:repeat(4,1fr) } }
.budget-page label{ display:flex; flex-direction:column; gap:6px; font-size:13px; color:var(--muted) }
.budget-page input, .budget-page select{
  background:var(--input-bg); border:1px solid var(--stroke); color:var(--text);
  border-radius:12px; padding:10px; font-size:14px; width:100%;
}
.budget-page input::placeholder{ color:#7681a1 }
.budget-page .btn{ font-weight:800 }
.budget-page .btn-primary{ background:linear-gradient(135deg, var(--brand), var(--brand2)); color:#0c0f21; border:1px solid transparent }
.budget-page .btn-danger{
  background:linear-gradient(135deg, #ff6b6b, #f43f5e); color:#fff;
  border:1px solid rgba(255,255,255,.08);
}
.hidden{ display:none !important; }

/* —Ç–∞–±—ã –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ */
.budget-page .tabs{ display:flex; gap:10px; flex-wrap:wrap; margin:8px 0 14px; max-width:100%; }
.budget-page .tab-btn{
  background:var(--input-bg); border:1px solid var(--stroke); color:var(--text);
  padding:8px 12px; border-radius:999px; cursor:pointer; font-weight:800
}
.budget-page .tab-btn--active{
  background:linear-gradient(135deg, var(--brand), var(--brand2)); border:none; color:#0c0f21
}

/* —Ç–∞–±–ª–∏—Ü—ã */
.budget-page .table{ width:100%; max-width:100%; border-collapse:collapse; table-layout:fixed; }
.budget-page .table th,.budget-page .table td{
  border-bottom:1px solid var(--stroke); padding:10px; font-size:14px; vertical-align:middle;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.budget-page .table th{ color:var(--muted); font-weight:800 }
.budget-page .t-right{text-align:right} .budget-page .t-center{text-align:center}
.col-date{ width:92px }
.col-sum{ width:130px }

/* –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Å–ª–µ–≤–∞ */
.col-cat, .budget-page th.col-cat{ text-align:left; }

.col-desc{ width:auto }
.cell-clip{ display:block; max-width: clamp(120px, 35vw, 420px); overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

/* —Å—Ç—Ä–æ–∫–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã */
.table tbody tr[data-clickrow]{ cursor:pointer; }

/* —Ä–∞—Å–∫—Ä—ã–≤–∞—à–∫–∞ */
.row-more td{ padding-top:8px; }
.row-more__box{
  background:var(--input-bg); border:1px solid var(--stroke);
  border-radius:10px; padding:10px; font-size:13px; color:var(--muted);
}

/* –±–µ–π–¥–∂–∏ */
.budget-page .pill{ display:inline-flex; align-items:center; padding:4px 8px; border-radius:999px; font-weight:800; font-size:12px }
.budget-page .pill--inc{ background:#0f5132; color:#b6f7d2; border:1px solid #0b3b24 }
.budget-page .pill--exp{ background:#5a1a1a; color:#ffd6d6; border:1px solid #3d1010 }
.budget-page .pill--tr{ background:#20385b; color:#cfe2ff; border:1px solid #162a46 }

/* –≥—Ä–∞—Ñ–∏–∫–∏ */
:root{ --chart-h: 280px; }
.budget-page .chart-box{
  position:relative; overflow:hidden; background:var(--input-bg); border:1px solid var(--stroke);
  border-radius:12px; padding:6px; max-width:100%;
}
.budget-page .chart-box canvas{ display:block; width:100% !important; height:var(--chart-h) !important; }

/* —Ä–µ–≥–∏—Å—Ç—Ä –≤–∫–ª–∞–¥–æ–∫ */
.budget-page .ledger{ display:none } .budget-page .ledger.visible{ display:block }

/* —Ç—É–º–±–ª–µ—Ä –≤ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–∞—Ö */
.budget-page .chk{
  appearance:none; -webkit-appearance:none; width:38px; height:20px; border-radius:999px;
  background:rgba(255,255,255,.06); border:1px solid var(--stroke); position:relative; cursor:pointer;
  transition:background .18s ease, border-color .18s ease;
}
.budget-page .chk::after{
  content:""; position:absolute; top:2px; left:2px; width:16px; height:16px; border-radius:50%;
  background:#a0a7c9; transition:left .18s ease, background .18s ease, box-shadow .18s ease;
}
.budget-page .ob-row.done .chk,
.budget-page .chk:checked{ background:rgba(6,214,160,.25); border-color:var(--ok) }
.budget-page .ob-row.done .chk::after,
.budget-page .chk:checked::after{ left:20px; background:var(--ok); box-shadow:0 0 0 2px rgba(6,214,160,.35) inset }
.budget-page .ob-row.overdue .chk:not(:checked){ background:rgba(248,106,164,.15); border-color:var(--accent) }
.budget-page .ob-row.overdue .chk:not(:checked)::after{ background:#f86aa4 }
.budget-page .ob-row.overdue td:first-child{ color:var(--accent); font-weight:800 }
.budget-page .ob-row.done    td:first-child{ color:var(--ok) }

/* ===== MODAL ===== */
.modal[hidden]{ display:none !important; }
.modal{
  display:block !important;
  position:fixed !important; inset:0 !important;
  z-index:2147483647 !important; pointer-events:auto !important;
}
.modal__backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.45); backdrop-filter: blur(2px); }
.modal__dialog{
  position:relative; z-index:1; margin:10vh auto 6vh; max-width:960px;
  background:var(--dialog-bg, #11182f); border:1px solid var(--stroke);
  color:var(--text); border-radius:16px; box-shadow:var(--shadow-xl);
  padding:20px; width:calc(100% - 32px);
}
html[data-theme="light"] .modal__dialog{ --dialog-bg:#ffffff }
.modal__header{ display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:12px }
.modal__header h3{ margin:0; font-size:22px }
.modal__close{ border:1px solid var(--stroke); width:34px; height:34px; border-radius:10px; background:var(--input-bg); color:var(--text) }
.modal__footer{ display:flex; justify-content:flex-end; margin-top:8px }

/* —Å–µ–≥–º–µ–Ω—Ç—ã –≤ –º–æ–¥–∞–ª–∫–∞—Ö */
.seg{ display:inline-flex; gap:8px; padding:6px; background:var(--input-bg); border:1px solid var(--stroke); border-radius:12px; margin-bottom:12px }
.seg-btn{ border:0; padding:8px 12px; border-radius:999px; font-weight:800; cursor:pointer; background:transparent; color:var(--text); opacity:.8 }
.seg-btn.is-active{ opacity:1; color:#0c0f21; background:linear-gradient(135deg, var(--brand), var(--brand2)) }

/* ====== –¢–ê–ë–õ–ò–¶–ê –ö–ê–¢–ï–ì–û–†–ò–ô (—Ñ–∏–∫—Å –∫–æ–ª–æ–Ω–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π) ====== */
.table--cats{ table-layout:fixed; }
.table--cats .col-actions{ width:120px; }              /* –ü–ö: –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –ø–æ–¥ –∫–Ω–æ–ø–∫—É */
.table--cats td:last-child,
.table--cats th:last-child{
  overflow:visible;                                     /* –Ω–µ –ø—Ä—è—á–µ–º –∫–Ω–æ–ø–∫—É */
  white-space:nowrap;
}

/* –∫–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è */
.table--cats .btn-del{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:8px 12px;
  border-radius:10px;
}

/* –ú–æ–±–∏–ª—å–Ω—ã–µ (iPhone 12 Pro –∏ –¥—Ä.) */
@media (max-width: 420px){
  :root{ --chart-h: 220px; }
  .budget-page .kpis{ grid-template-columns:1fr 1fr }
  .budget-page .grid--2{ grid-template-columns:1fr }
  .budget-page .btn, .btn-add{ width:100% }
  .t-hide-sm{ display:none }                 /* –ø—Ä—è—á–µ–º –∫–æ–ª–æ–Ω–∫—É ¬´–û–ø–∏—Å–∞–Ω–∏–µ¬ª */
  .budget-page .table th,.budget-page .table td{ font-size:13px; padding:8px }
  .table--cats .col-actions{ width:56px; }   /* –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –ø–æ–¥ –∏–∫–æ–Ω–∫—É */
  .table--cats .btn-del{
    width:36px; height:36px; padding:6px;
    justify-content:center;
  }
  .table--cats .btn-del .txt{ display:none; }/* –ø—Ä—è—á–µ–º —Ç–µ–∫—Å—Ç, –æ—Å—Ç–∞—ë—Ç—Å—è üóë */
}

/* –¥–æ–ø. —Å—Ç–∏–ª—å –∫—Ä–∞—Å–Ω–æ–π –∫–Ω–æ–ø–∫–∏ (–≤ —Ç–∞–±–ª–∏—Ü–∞—Ö) */
.btn-danger, .budget-page .btn-danger{ background:#e6536b; border-color:#e6536b; color:#0c0f21; }
