<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title id="pageTitle">–ú–æ–π –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å</title>

<script>
  if (!localStorage.getItem('pf_token')) {
    window.location.replace('login.html');
  }
</script>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/axios@1.7.2/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>

<link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>
<div class="aurora"></div>
<div class="blob one"></div>
<div class="blob two"></div>

<div class="container">
  <header>
    <div class="title-wrap">
      <h1 id="portfolioTitle">‚ú® –ú–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å</h1>
      <button id="editTitleBtn" class="title-edit" title="–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ">‚úèÔ∏è</button>
    </div>
    <div class="header-actions">
      <div class="search-wrap">
        <input id="searchInput" type="text" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ç–∏–∫–µ—Ä–∞–º/–Ω–∞–∑–≤–∞–Ω–∏—é‚Ä¶" />
      </div>
      <!-- –ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: –≤ –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–π —à–∞–ø–∫–µ -->
      <button id="openAddBtn" class="btn btn-primary" title="–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>

      <button class="btn btn-ghost" id="toggleAllBtn" title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏">‚§¥Ô∏è –í—Å–µ</button>
      <div id="authStatus" class="auth-status">–ì–æ—Å—Ç—å</div>
      <button id="logoutBtn" class="btn btn-danger" title="–í—ã–π—Ç–∏">üö™ –í—ã–π—Ç–∏</button>
      <button id="refreshBtn" class="btn" title="–û–±–Ω–æ–≤–∏—Ç—å –∫–æ—Ç–∏—Ä–æ–≤–∫–∏">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
      <button id="themeToggle" class="btn" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">üåì –¢–µ–º–∞</button>
      <button id="apiStatusBtn" class="btn" title="–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Tinkoff Invest API">
        üîå <span id="apiStatusDot" style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#888;margin-left:6px;"></span>
      </button>
    </div>
  </header>

  <div class="portfolio-charts">
    <div class="chart-card animate-in skeleton" id="sk1"><h3>–ê–ª–ª–æ–∫–∞—Ü–∏—è –ø–æ –∫–ª–∞—Å—Å–∞–º</h3><canvas id="chartByClass"></canvas></div>
    <div class="chart-card animate-in skeleton" id="sk2"><h3>–ê–ª–ª–æ–∫–∞—Ü–∏—è –ø–æ —Ç–∏–∫–µ—Ä–∞–º (—Å—Ç–æ–∏–º–æ—Å—Ç—å)</h3><canvas id="chartByTickerValue"></canvas></div>
    <div class="chart-card animate-in skeleton" id="sk3"><h3>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—É–º–∞–≥ –ø–æ —Ç–∏–∫–µ—Ä–∞–º</h3><canvas id="chartByTickerQty"></canvas></div>
  </div>

  <h2 class="zone-title">–ò—Ç–æ–≥–∏</h2>
  <div class="portfolio-summary" id="portfolioSummary"></div>

  <h2 class="zone-title">–ü–æ–∑–∏—Ü–∏–∏</h2>
  <div id="portfolioSections"></div>

  <!-- –†–∞–∑–¥–µ–ª —Å —Ñ–æ—Ä–º–æ–π –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –ª—é–±–∏—Ç –¥–æ–±–∞–≤–ª—è—Ç—å ¬´–≤–Ω–∏–∑—É¬ª).
       –í –º–æ–¥–∞–ª–∫—É —Ñ–æ—Ä–º–∞ –±—É–¥–µ—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –ü–ï–†–ï–ù–û–°–ò–¢–¨–°–Ø –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏, –ø–æ—ç—Ç–æ–º—É id –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è. -->
  <div class="section animate-in" id="addSection">
    <h2 style="margin-bottom:10px">–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤</h2>
    <div id="addFormWrap">
      <form id="assetForm">
        <div class="form-grid">
          <div class="form-group">
            <label for="assetType">–¢–∏–ø –∞–∫—Ç–∏–≤–∞</label>
            <div class="select-wrap">
              <select id="assetType" required>
                <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                <option value="stock">–ê–∫—Ü–∏—è</option>
                <option value="bond">–û–§–ó/–û–±–ª–∏–≥–∞—Ü–∏—è</option>
                <option value="fund">–§–æ–Ω–¥/ETF</option>
                <option value="savings">–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π —Å—á—ë—Ç</option>
              </select>
            </div>
          </div>

          <div class="form-group" id="fieldName">
            <label for="assetName">–¢–∏–∫–µ—Ä / –ù–∞–∑–≤–∞–Ω–∏–µ</label>
            <input type="text" id="assetName" placeholder="SBER, YNDX, TGLD" />
          </div>
          <div class="form-group" id="fieldQuantity">
            <label for="assetQuantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</label>
            <input type="number" id="assetQuantity" min="0" step="1" placeholder="–ù–∞–ø—Ä.: 10" />
          </div>
          <div class="form-group" id="fieldPrice">
            <label for="assetAvgPrice">–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ (‚ÇΩ)</label>
            <input type="number" id="assetAvgPrice" step="0.0001" min="0" placeholder="–ù–∞–ø—Ä.: 4383" />
          </div>

          <div class="form-group" id="fieldSavingsAmount" style="display:none;">
            <label for="savingsAmount">–°—É–º–º–∞ (‚ÇΩ)</label>
            <input type="number" id="savingsAmount" min="0" step="0.01" placeholder="–ù–∞–ø—Ä.: 100000" />
          </div>

          <div class="form-group" id="fieldDate">
            <label for="assetDate">–î–∞—Ç–∞ –ø–æ–∫—É–ø–∫–∏/–≤–Ω–µ—Å–µ–Ω–∏—è</label>
            <input type="text" id="assetDate" placeholder="–¥–¥.–º–º.–≥–≥–≥–≥" />
          </div>
        </div>

        <div class="form-actions">
          <button type="reset" class="btn" id="resetBtn">–û—á–∏—Å—Ç–∏—Ç—å</button>
          <button type="submit" class="btn btn-primary" id="addBtn">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Toasts -->
<div class="toast-wrap" id="toastWrap"></div>

<!-- FAB –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
<button id="fabAddBtn" class="fab" title="–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤">Ôºã</button>

<!-- –ú–æ–¥–∞–ª–∫–∞: –¥–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤ (—Å—é–¥–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è addFormWrap) -->
<div id="addModal" class="modal" aria-hidden="true">
  <div class="modal__dialog">
    <div class="modal__header">
      <h3>–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤</h3>
      <button class="modal__close" id="addCloseX" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
    </div>
    <div id="addModalHost"></div>
    <div class="modal__footer">
      <button id="addCloseBtn" class="btn btn-ghost">–û—Ç–º–µ–Ω–∞</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞: –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é -->
<div id="editModal" class="modal" aria-hidden="true">
  <div class="modal__dialog">
    <div class="modal__header">
      <h3 id="editTitle">–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é</h3>
      <button class="modal__close" id="editCancelX" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
    </div>
    <div class="form-grid">
      <div class="form-group">
        <label>FIGI</label>
        <div id="editFigi" class="readonly-box">‚Äî</div>
      </div>
      <div class="form-group">
        <label for="editDeltaQty">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (Œî)</label>
        <input id="editDeltaQty" type="number" placeholder="+/- —à—Ç. (–ø–æ–∫—É–ø–∫–∞ = +, –ø—Ä–æ–¥–∞–∂–∞ = -)" />
      </div>
      <div class="form-group">
        <label for="editPrice">–¶–µ–Ω–∞ —Å–¥–µ–ª–∫–∏</label>
        <input id="editPrice" type="number" step="0.0001" placeholder="–¶–µ–Ω–∞ –∑–∞ 1 —à—Ç." />
      </div>
      <div class="form-group">
        <label for="editDate">–î–∞—Ç–∞ —Å–¥–µ–ª–∫–∏</label>
        <input id="editDate" type="text" placeholder="–¥–¥.–º–º.–≥–≥–≥–≥" />
      </div>
    </div>
    <div class="modal__footer">
      <button id="editCancelBtn" class="btn btn-ghost">–û—Ç–º–µ–Ω–∞</button>
      <button id="editSaveBtn" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞: —Ç–æ–∫–µ–Ω –¢–∏–Ω—å–∫–æ—Ñ—Ñ -->
<div id="tokenModal" class="modal" aria-hidden="true">
  <div class="modal__dialog">
    <div class="modal__header">
      <h3>–¢–æ–∫–µ–Ω –¢–∏–Ω—å–∫–æ—Ñ—Ñ</h3>
      <button class="modal__close" id="modalCancelX" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
    </div>
    <p class="muted">–¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º —Ä—ã–Ω–∫–∞.</p>
    <label for="modalTinkoffToken">–ù–æ–≤—ã–π —Ç–æ–∫–µ–Ω</label>
    <input id="modalTinkoffToken" type="password" placeholder="t.xxxxx" />
    <div class="modal__footer">
      <button id="modalCancelBtn" class="btn btn-ghost">–û—Ç–º–µ–Ω–∞</button>
      <button id="modalClearBtn" class="btn btn-danger">–û—á–∏—Å—Ç–∏—Ç—å</button>
      <button id="modalSaveBtn" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>
</div>

<script defer src="assets/js/script.js"></script>
</body>
</html>
