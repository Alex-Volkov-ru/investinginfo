<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–û–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ ‚Ä¢ –ü–æ—Ä—Ç—Ñ–µ–ª—å</title>

  <script>
    if (!localStorage.getItem('pf_token')) {
      window.location.replace('login.html');
    }
    // Initialize theme
    document.documentElement.setAttribute('data-theme', localStorage.getItem('pf_theme') || 'dark');
  </script>

  <!-- Critical CSS -->
  <link rel="stylesheet" href="assets/css/critical.css" />
  
  <!-- Non-critical resources -->
  <link rel="preload" href="assets/css/style.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="assets/css/obligations.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript>
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/obligations.css" />
  </noscript>

  <!-- –ú–æ–±–∏–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ -->
  <meta name="theme-color" content="#4361ee">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>
  <div class="aurora"></div>
  <div class="blob one"></div>
  <div class="blob two"></div>

  <div class="container">
    <header class="app-header">
      <div class="search-wrap">
        <input id="searchInput" type="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é/–æ–ø–∏—Å–∞–Ω–∏—é‚Ä¶" />
      </div>

      <div class="header-actions">
        <button id="refreshBtn" class="btn" title="–û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (R)"><span>üîÑ –û–±–Ω–æ–≤–∏—Ç—å</span></button>
        <button id="themeToggle" class="btn" title="–¢—ë–º–Ω–∞—è/—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ (T)"><span>üåì –¢–µ–º–∞</span></button>
        <div id="authStatus" class="auth-status">–ì–æ—Å—Ç—å</div>
        <button id="logoutBtn" class="btn btn-danger" title="–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞"><span>‚éã –í—ã–π—Ç–∏</span></button>
        <button id="helpBtn" class="btn" title="–°–ø—Ä–∞–≤–∫–∞ –∏ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ (?)"><span>‚ùì –°–ø—Ä–∞–≤–∫–∞</span></button>
      </div>
    </header>

    <!-- –ü–ª–∞—à–∫–∏ —Å –∏—Ç–æ–≥–∞–º–∏ -->
    <section class="totals-section">
      <h2 class="section-title">–ò–¢–û–ì–ò</h2>
      <div class="totals-grid">
        <div class="total-card">
          <div class="total-label">–í–°–ï–ì–û</div>
          <div class="total-value" id="totalAll">0 ‚ÇΩ</div>
        </div>
        <div class="total-card">
          <div class="total-label">–ö–†–ï–î–ò–¢–´</div>
          <div class="total-value" id="totalCredits">0 ‚ÇΩ</div>
        </div>
        <div class="total-card">
          <div class="total-label">–û–ü–õ–ê–ß–ï–ù–û</div>
          <div class="total-value" id="totalPaid">0 ‚ÇΩ</div>
        </div>
        <div class="total-card">
          <div class="total-label">–û–°–¢–ê–õ–û–°–¨</div>
          <div class="total-value" id="totalRemaining">0 ‚ÇΩ</div>
        </div>
      </div>
    </section>

    <nav class="tabs-row">
      <a class="tab" href="index.html">–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</a>
      <a class="tab" href="budget.html">–ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
      <a class="tab active" href="obligations.html" aria-current="page">–û–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞</a>
    </nav>

    <div class="title-row" style="margin-top:6px;">
      <div class="muted">‚ñ∏</div>
      <button id="toggleAllBtn" class="btn btn-ghost" title="–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å/—Å–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏ (S)">‚§¥Ô∏è –í—Å–µ</button>
    </div>

    <!-- –ú–æ–∏ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ -->
    <section class="section open" id="obSection">
      <div class="section-header">
        <button class="section-toggle" data-action="toggle-section" data-section="obSection">
          <span class="chev">‚ñ∏</span> –ú–æ–∏ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞
        </button>
        <div class="section-meta">
          <button id="addObBtn" class="btn btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ</button>
        </div>
      </div>
      <div class="section-body">
        <div id="obList" class="ob-list"></div>
        <div id="obEmpty" class="empty-state" style="display:none">
          –ü–æ–∫–∞ –ø—É—Å—Ç–æ. –ù–∞–∂–º–∏ ¬´–î–æ–±–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ¬ª.
        </div>
      </div>
    </section>
  </div>

  <!-- Toasts -->
  <div class="toast-wrap" id="toastWrap"></div>

  <!-- –°–ø—Ä–∞–≤–∫–∞ / —Ö–æ—Ç–∫–µ–∏ -->
  <div class="modal" id="helpModal">
    <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
      <div class="modal__header">
        <h3 id="helpTitle">–°–ø—Ä–∞–≤–∫–∞ –∏ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏</h3>
        <button class="modal__close" id="helpCloseX" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal__content">
        <ul class="help-list">
          <li><span class="kbd">/</span> ‚Äî —Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–∏—Å–∫</li>
          <li><span class="kbd">R</span> ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</li>
          <li><span class="kbd">T</span> ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É</li>
          <li><span class="kbd">S</span> ‚Äî —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å/—Å–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏</li>
          <li><span class="kbd">?</span> ‚Äî –æ—Ç–∫—Ä—ã—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É</li>
        </ul>
      </div>
      <div class="modal__footer">
        <button id="helpCloseBtn" class="btn btn-primary">–ü–æ–Ω—è—Ç–Ω–æ</button>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ ¬´–ù–æ–≤–æ–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ¬ª -->
  <div class="modal" id="createObModal">
    <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="createTitle">
      <div class="modal__header">
        <h3 id="createTitle">–ù–æ–≤–æ–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ</h3>
        <button class="modal__close" id="createCloseX" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      </div>
      <div class="modal__content">
        <label class="label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
        <input id="createNameInput" class="input" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö—Ä–µ–¥–∏—Ç –Ω–∞–ª–∏—á–Ω—ã–º–∏" />
      </div>
      <div class="modal__footer">
        <button id="createCancelBtn" class="btn">–û—Ç–º–µ–Ω–∞</button>
        <button id="createCreateBtn" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- Modal: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å -->
<div class="ob-modal" id="renameObModal">
    <div class="ob-modal__dialog">
      <div class="ob-modal__header">
        <div>–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ</div>
        <button class="ob-modal__close" id="renameCloseX">‚úï</button>
      </div>
      <div class="ob-modal__content">
        <label>–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ</label>
        <input class="input" id="renameNameInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö—Ä–µ–¥–∏—Ç –Ω–∞–ª–∏—á–Ω—ã–º–∏" />
      </div>
      <div class="ob-modal__footer">
        <button class="btn btn-ghost" id="renameCancelBtn">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn" id="renameOkBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>
  
  <!-- Modal: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è -->
  <div class="ob-modal" id="confirmObModal">
    <div class="ob-modal__dialog">
      <div class="ob-modal__header">
        <div>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</div>
        <button class="ob-modal__close" id="confirmCloseX">‚úï</button>
      </div>
      <div class="ob-modal__content" id="confirmText">–£–¥–∞–ª–∏—Ç—å –±–ª–æ–∫?</div>
      <div class="ob-modal__footer">
        <button class="btn btn-ghost" id="confirmCancelBtn">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn btn-danger" id="confirmOkBtn">–£–¥–∞–ª–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- –ö–Ω–æ–ø–∫–∞ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ -->
  <button id="compactToggle" title="–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ä–µ–∂–∏–º">üì±</button>

  <script src="https://cdn.jsdelivr.net/npm/axios@1.6.8/dist/axios.min.js"></script>
  <script src="assets/js/network-optimizer.js"></script>
  <script src="assets/js/drafts.js"></script>
  <script src="assets/js/obligations.js"></script>
</body>
</html>
