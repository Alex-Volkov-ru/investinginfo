-- Миграция: добавление поля для хранения зашифрованных сумм транзакций
-- Это обеспечивает защиту финансовых данных клиентов

-- Добавляем поле для зашифрованной суммы
ALTER TABLE pf.budget_transactions
  ADD COLUMN IF NOT EXISTS amount_encrypted TEXT;

-- Комментарий к полю
COMMENT ON COLUMN pf.budget_transactions.amount_encrypted IS 
  'Зашифрованная сумма транзакции для защиты данных клиента. Используется Fernet шифрование.';

-- Поле amount остается для обратной совместимости и миграции существующих данных
-- В будущем можно будет удалить его после миграции всех данных

